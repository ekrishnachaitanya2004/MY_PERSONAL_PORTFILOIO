---
type Props = {
  emoji?: string;
};

const { emoji = "❤️" } = Astro.props;
---

<div class="blog-background" data-emoji={emoji}>
  {Array.from({ length: 25 }).map((_, index) => {
    const randomX = Math.random() * 100;
    const randomY = Math.random() * 100;
    const randomRotation = Math.random() * 360;
    const randomDelay = Math.random() * 3;
    const randomSize = 0.6 + Math.random() * 0.4; // Random size between 0.6 and 1.0
    const animationDuration = 40 + Math.random() * 30; // Random duration between 40-70s for slow motion
    
    return (
      <div 
        class="background-element"
        style={`
          left: ${randomX}%;
          top: ${randomY}%;
          --rotation: ${randomRotation}deg;
          --scale: ${randomSize};
          --delay: ${randomDelay}s;
          --duration: ${animationDuration}s;
        `}
      >
        <span class="emoji-text">{emoji}</span>
      </div>
    );
  })}
</div>

<style>
  .blog-background {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
    pointer-events: none;
    overflow: hidden;
    opacity: 0.15;
  }

  html.dark .blog-background {
    opacity: 0.2;
  }

  .background-element {
    position: absolute;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: clamp(1.5rem, 2.5vw, 2.2rem);
    white-space: nowrap;
    animation: float var(--duration, 50s) ease-in-out infinite;
    animation-delay: var(--delay, 0s);
    transform: rotate(var(--rotation, 0deg)) scale(var(--scale, 1));
    user-select: none;
    line-height: 1;
  }

  .emoji-text {
    display: block;
    animation: pulse 8s ease-in-out infinite;
    opacity: 0.85;
  }

  @keyframes float {
    0%, 100% {
      transform: translateY(0) translateX(0) rotate(var(--rotation, 0deg)) scale(var(--scale, 1));
    }
    25% {
      transform: translateY(-20px) translateX(10px) rotate(calc(var(--rotation, 0deg) + 2deg)) scale(var(--scale, 1));
    }
    50% {
      transform: translateY(-10px) translateX(-5px) rotate(calc(var(--rotation, 0deg) - 2deg)) scale(var(--scale, 1));
    }
    75% {
      transform: translateY(-15px) translateX(8px) rotate(calc(var(--rotation, 0deg) + 1deg)) scale(var(--scale, 1));
    }
  }

  @keyframes pulse {
    0%, 100% {
      transform: scale(1);
      opacity: 0.8;
    }
    50% {
      transform: scale(1.1);
      opacity: 0.95;
    }
  }

  /* Ensure content is above background */
  .page-content {
    position: relative;
    z-index: 1;
  }

  @media (max-width: 768px) {
    .blog-background {
      opacity: 0.12;
    }

    html.dark .blog-background {
      opacity: 0.18;
    }

    .background-element {
      font-size: 1.3rem;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .background-element {
      animation: none;
    }

    .emoji-text {
      animation: none;
    }
  }
</style>
