---
import { getCollection } from "astro:content";
import MainLayout from "../layouts/MainLayout.astro";
import siteConfig from "../site.config";
import { sortItemsByDateDesc, withBase } from "../utils/helpers";
import PostCardPreview from "../components/PostCardPreview.astro";
import Button from "../components/Button.astro";
import ArrowRight from "../icons/ArrowRight.astro";

const allPosts = (await getCollection("blogs"))
  .filter((post) => !post.data.draft)
  .sort(sortItemsByDateDesc);
---

<MainLayout
  activePage="home"
  pageTitle={siteConfig.title + " | An Astro Personal Blog Template"}
>
  <div
    class="jumbo-banner flex flex-col sm:flex-row sm:items-center sm:justify-between w-full px-4 my-12 gap-6"
  >
    <div class="w-full sm:w-1/2 sm:max-w-md hero-text-container relative z-10">
      {
        siteConfig.hero?.eyebrowText && (
          <span class="tag rounded-full text-xs px-2 py-0 border border-gray-500 kanit-light inline-flex items-center gap-1 mb-4">
            {siteConfig.hero?.eyebrowText}
              <img 
                src={withBase("/Illustration-of-check-mark-icon-in-blue-color-on-transparent-background-PNG-removebg-preview.png")}
                alt="Verified"
                class="verified-icon"
              />
          </span>
        )
      }
      <h1 class="sigmar-ff leading-tight sm:pt-0! hero-name">
        Krishna Ethamukkala
      </h1>
      <p class="kanit-regular text-balance text-xs sm:text-base">
        {siteConfig.hero?.text}
      </p>
      <div
        class="flex flex-wrap items-center text-xs sm:text-base gap-x-2 gap-y-4 mt-2 sm:mt-4"
      >
        {
          siteConfig.hero?.actions?.map((action, index) => (
            <Button
              href={action.href}
              class={index === 0 ? "space-btn-filled" : "space-btn-outlined"}
            >
              {action.text}
            </Button>
          ))
        }
      </div>
    </div>
    <div class="w-full sm:w-[60%] sm:max-w-md hero-image-container relative z-0">
      <img
        class="cover-img rounded-xl object-cover h-auto hero-image"
        src={withBase("/krishnaFULLPHOTO.jpeg")}
        alt="Krishna Chaitanya Ethamukkala"
        width="400"
        height="500"
      />
    </div>
  </div>
  
  <!-- About Section -->
  <div class="page-content">
    <section class="about-intro-section">
      <div class="about-intro-content">
        <p class="comfortaa-regular">
          Hey, this is my personal About page.
        </p>
        <p class="comfortaa-regular">
          Everything on this website the blogs, projects, and write-ups is professional. This is not a personal diary. This is my professional portfolio, showing my work, experience, and the things I've built. Anything personal stays out of this space.
        </p>
        <p class="comfortaa-regular">
          I'm Krishna, and I'm the owner and founder of the Krypto Hashers Community (KHC). There was a time when KHC was alive and doing solid work. It wasn't perfect, but it was real. Now, I'll say it straight "it's almost dead" because I've been inactive for more than half a year. Still, a few people are doing crazy things to keep it alive, and that's the only reason it still exists today.
        </p>
        <p class="comfortaa-regular">
          Right now, I'm not in the mode of collaborating with people or running communities. I've stepped back on purpose. I made a decision that I regretchoosing to pursue a master's degree as an international student. It's killing my productive time and energy and not letting me do my own things, even the ones that might look useless to others. I used to build useless projects and random experiments freely, but now I'm stuck doing a useless degree. Honestly, the things I did in the past were far better than this funny degree. I keep thinking about the time when I was at home happy, without pressure, with my time and productivity fully in my control.
        </p>
        <p class="comfortaa-regular">
          Anyway, that's where I'm at right now. No excuses. No drama. Just reality. I'm still figuring out what comes next.
        </p>
        <p class="comfortaa-regular">
          I've written some crazy stuff here,you'll find it in the blog section. These are technical, experimental, and professional. They reflect how I think and how I build.
        </p>
        <p class="comfortaa-regular">
          If you want to read my personal blogs the real me ,they exist online, but you'll have to find them yourself. They're not for the general public. If you're genuinely curious and a little crazy, you'll find them easily. I don't mind if a crazy Dev reads them,I just don't promote them.
        </p>
        <p class="comfortaa-regular">
          Below is my basic profile. Go through it if you want.
        </p>
      </div>
    </section>
  </div>

  <div class="page-content">
    <div id="posts" class="flex flex-col items-center justify-center w-full">
      <h2 class="sigmar-ff text-balance pt-0! pb-3! mb-2!">Recent Stories</h2>
      <div class="flex flex-col gap-4 max-w-full text-left">
        {
          allPosts
            .slice(0, siteConfig.recentPostLimit)
            .map((post) => <PostCardPreview post={post} />)
        }
      </div>
      <Button href={withBase("/blog")} class="space-btn-filled mt-4">
        View All Posts <ArrowRight class="w-5 h-5 fill-current ml-4" />
      </Button>
    </div>
  </div>
</MainLayout>

<style>
  .jumbo-banner {
    position: relative;
  }
  
  .hero-text-container {
    flex-shrink: 0;
    min-width: 0;
  }
  
  .hero-image-container {
    flex-shrink: 0;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  
  .hero-image {
    width: 80%;
    height: auto;
    max-width: 100%;
    opacity: 0.6;
  }
  
  .hero-name {
    font-size: clamp(1.4rem, 3.6vw, 3.2rem);
    word-break: keep-all;
    overflow-wrap: normal;
    hyphens: none;
    line-height: 1.1;
    position: relative;
    z-index: 10;
  }
  
  /* Ensure text container doesn't overlap image */
  @media (min-width: 640px) {
    .hero-text-container {
      padding-right: 1rem;
    }
    
    .hero-image-container {
      padding-left: 1rem;
    }
  }
  
  /* Allow wrapping only at the space between names on small screens */
  @media (max-width: 640px) {
    .hero-name {
      white-space: normal;
    }
  }
  
  /* Prevent breaking within words */
  .hero-name {
    word-spacing: normal;
  }

  .verified-icon {
    width: 16px;
    height: 16px;
    display: inline-block;
    vertical-align: middle;
    margin-left: 0.25rem;
    flex-shrink: 0;
  }

  .about-intro-section {
    max-width: 800px;
    margin: 0 auto 3rem;
    padding: 0 1rem;
  }

  .about-intro-content {
    background: rgba(255, 255, 255, 0.02);
    border: none;
    border-radius: 1rem;
    padding: 2rem;
  }

  html.light .about-intro-content {
    background: rgba(0, 0, 0, 0.02);
  }

  .about-intro-content p {
    font-size: 1.05rem;
    line-height: 1.8;
    margin-bottom: 1rem;
    color: inherit;
  }

  .about-intro-content p:last-child {
    margin-bottom: 0;
  }

  @media (max-width: 768px) {
    .about-intro-section {
      margin-bottom: 2rem;
      padding: 0 0.5rem;
    }

    .about-intro-content {
      padding: 1.5rem;
    }

    .about-intro-content p {
      font-size: 1rem;
    }
  }
</style>
